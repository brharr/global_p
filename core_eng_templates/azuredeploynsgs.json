{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "nCERT-CDE-LJUMP-ANY-ADMIN":{ "type": "string" },
        "nCERT-CDE-SMTP-ANY-ADMIN":{ "type": "string" },
        "nCERT-CDE-WJUMP-ANY-ADMIN":{ "type": "string" },
        "nCERT-NCDE-LJUMP-ANY-ADMIN":{ "type": "string" },
        "nCERT-NCDE-SMTP-ANY-ADMIN":{ "type": "string" },
        "nCERT-NCDE-WJUMP-ANY-ADMIN":{ "type": "string" },
        "nPROD-CDE-WSUS-ANY-ADMIN": { "type": "string" },
        "nPROD-CDE-AVM-ANY-ADMIN": { "type": "string" },
        "nPROD-CDE-IEM-ANY-ADMIN": { "type": "string" },
        "nPROD-CDE-ITBX-ANY-ADMIN":{ "type": "string" },
        "nPROD-CDE-LIC-ANY-ADMIN": { "type": "string" },
        "nPROD-CDE-AD-ANY-ADMIN": { "type": "string" },
        "nPROD-CDE-LJUMP-ANY-ADMIN": { "type": "string" },
        "nPROD-CDE-SMTP-ANY-ADMIN": { "type": "string" },
        "nPROD-CDE-WJUMP-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-LJUMP-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-SMTP-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-WJUMP-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-SCAN-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-DNS-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-AD-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-WSUS-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-REPO-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-AVM-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-IEM-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-LIC-ANY-ADMIN": { "type": "string" },
        "nDEV-LJUMP-ANY-ADMIN": { "type": "string" },
        "nDEV-WJUMP-ANY-ADMIN": { "type": "string" },
        "nDEV-SMTP-ANY-ADMIN":  { "type": "string" },
        "nQA-LJUMP-ANY-ADMIN": { "type": "string" },
        "nQA-WJUMP-ANY-ADMIN": { "type": "string" },
        "nQA-SMTP-ANY-ADMIN":  { "type": "string" },
        "nPROD-NCDE-ITBX-WSS-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-GIT-PUP-WSS-ANY-ADMIN": { "type": "string" },
        "nPROD-NCDE-GIT-SAT-ANY-ADMIN": { "type": "string" }
     },
    "variables": { },
    "resources": [
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nCERT-CDE-LJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "admin-a-c-jump-app-all-any",
                        "properties": {
                            "description": "Allow CERT-CDE Tier2 Jumpservers to CERT-CDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.72.0/23",
                                "10.49.72.0/23"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-CDE to DNS Loadbalanicer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-c-all-any-repo-app",
                        "properties": {
                            "description": "Allow CERT-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-c-all-any-az-alb",
                        "properties": {
                            "description": "Allow CERT-CDE to CERT-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.66.23/32",
                                "10.49.66.23/32",
                                "10.50.66.23/32",
                                "10.51.66.23/32",
                                "10.52.66.23/32",
                                "10.53.66.23/32"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nCERT-CDE-SMTP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "admin-a-c-jump-app-all-any",
                        "properties": {
                            "description": "Allow CERT-CDE Tier2 Jumpservers to CERT-CDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.72.0/23",
                                "10.49.72.0/23"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-CDE to DNS Loadbalanicer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-c-all-any-repo-app",
                        "properties": {
                            "description": "Allow CERT-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-c-all-any-az-alb",
                        "properties": {
                            "description": "Allow CERT-CDE to CERT-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.66.23/32",
                                "10.49.66.23/32",
                                "10.50.66.23/32",
                                "10.51.66.23/32",
                                "10.52.66.23/32",
                                "10.53.66.23/32"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "smtp-a-c-all-any-smtp-app",
                        "properties": {
                            "description": "Allow CERT-CDE to the CERT-CDE SMTP relays",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "smtp-a-c-smtp-app-pfpt-any",
                        "properties": {
                            "description": "Allow CERT-CDE to CERT-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "43025",
                                "43465"
                            ],
                            "sourceAddressPrefixes": [],
                            "DestinationAddressPrefixes": [
                                "67.231.148.213",
                                "67.231.156.212"
                            ]
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nCERT-CDE-WJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "admin-a-c-jump-app-all-any",
                        "properties": {
                            "description": "Allow CERT-CDE Tier2 Jumpservers to CERT-CDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.72.0/23",
                                "10.49.72.0/23"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-CDE to DNS Loadbalanicer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-c-all-any-repo-app",
                        "properties": {
                            "description": "Allow CERT-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-c-all-any-az-alb",
                        "properties": {
                            "description": "Allow CERT-CDE to CERT-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.66.23/32",
                                "10.49.66.23/32",
                                "10.50.66.23/32",
                                "10.51.66.23/32",
                                "10.52.66.23/32",
                                "10.53.66.23/32"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nCERT-NCDE-LJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-g-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPI DC's to GPI domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-g-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPI DC's to GPI domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "Allow CERT-NonCDE Tier2 Jumpservers to CERT-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.136.0/23",
                                "10.49.136.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-UDP",
                        "properties": {
                            "description": "UDP Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-TCP",
                        "properties": {
                            "description": "TCP Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 111,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 121,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-s-all-any-repo-app",
                        "properties": {
                            "description": "Allow CERT-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-s-all-any-az-alb",
                        "properties": {
                            "description": "Allow CERT-NCDE to CERT-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.130.23/32",
                                "10.49.130.23/32",
                                "10.50.130.23/32",
                                "10.51.130.23/32",
                                "10.52.130.23/32",
                                "10.53.130.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nCERT-NCDE-SMTP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-g-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPI DC's to GPI domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-g-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPI DC's to GPI domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "Allow CERT-NonCDE Tier2 Jumpservers to CERT-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.136.0/23",
                                "10.49.136.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-UDP",
                        "properties": {
                            "description": "UDP Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-TCP",
                        "properties": {
                            "description": "TCP Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 111,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 121,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-s-all-any-repo-app",
                        "properties": {
                            "description": "Allow CERT-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-s-all-any-az-alb",
                        "properties": {
                            "description": "Allow CERT-NCDE to CERT-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.130.23/32",
                                "10.49.130.23/32",
                                "10.50.130.23/32",
                                "10.51.130.23/32",
                                "10.52.130.23/32",
                                "10.53.130.23/32"
                            ]
                        }
                    },
                    {
                        "name": "smtp-a-s-all-any-smtp-app",
                        "properties": {
                            "description": "Allow CERT-CDE to the CERT-CDE SMTP relays",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "smtp-a-s-smtp-app-pfpt-any",
                        "properties": {
                            "description": "Allow CERT-CDE to CERT-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "43025",
                                "43465"
                            ],
                            "sourceAddressPrefixes": [],
                            "DestinationAddressPrefixes": [
                                "67.231.148.213",
                                "67.231.156.212"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nCERT-NCDE-WJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-g-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPI DC's to GPI domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-g-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPI DC's to GPI domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "Allow CERT-NonCDE Tier2 Jumpservers to CERT-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.136.0/23",
                                "10.49.136.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-UDP",
                        "properties": {
                            "description": "UDP Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-TCP",
                        "properties": {
                            "description": "TCP Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 111,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 121,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-s-all-any-repo-app",
                        "properties": {
                            "description": "Allow CERT-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-s-all-any-az-alb",
                        "properties": {
                            "description": "Allow CERT-NCDE to CERT-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.130.23/32",
                                "10.49.130.23/32",
                                "10.50.130.23/32",
                                "10.51.130.23/32",
                                "10.52.130.23/32",
                                "10.53.130.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-CDE-WSUS-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix" : "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix" : "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "admin-a-p-jump-app-all-any",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.40.0/23",
                                "10.49.40.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-p-itbx-app-all-any",
                        "properties": {
                            "description": "Allow CDE IT Toolbox servers to connect to CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-p-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow Edge and Prod-CDE to Prod-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.34.23/32",
                                "10.49.34.23/32",
                                "10.50.34.23/32",
                                "10.51.34.23/32",
                                "10.52.34.23/32",
                                "10.53.34.23/32"
                            ]
                        }
                    },
                    {
                        "name": "wsus-a-p-all-any-wsus-app",
                        "properties": {
                            "description": "Allow CDE to connect to CDE WSUS on update port",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "8531",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "wsus-a-p-wsus-app-internet-any",
                        "properties": {
                            "description": "Allow CDE WSUS server to connect to Whitelisted Windows Update Sources over HTTPS and HTTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-CDE-AVM-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix" : "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "SourceAddressPrefix" : "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "admin-a-p-jump-app-all-any",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.40.0/23",
                                "10.49.40.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-p-itbx-app-all-any",
                        "properties": {
                            "description": "Allow CDE IT Toolbox servers to connect to CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-p-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow Edge and Prod-CDE to Prod-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.34.23/32",
                                "10.49.34.23/32",
                                "10.50.34.23/32",
                                "10.51.34.23/32",
                                "10.52.34.23/32",
                                "10.53.34.23/32"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-CDE-IEM-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "admin-a-p-jump-app-all-any",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.40.0/23",
                                "10.49.40.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-p-itbx-app-all-any",
                        "properties": {
                            "description": "Allow CDE IT Toolbox servers to connect to CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-p-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow Edge and Prod-CDE to Prod-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.34.23/32",
                                "10.49.34.23/32",
                                "10.50.34.23/32",
                                "10.51.34.23/32",
                                "10.52.34.23/32",
                                "10.53.34.23/32"
                            ]
                        }
                    },
                    {
                        "name": "iem-a-p-all-any-iem-app",
                        "properties": {
                            "description": "All CDE networks to CDE IEM server",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "53211",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "iem-a-p-iem-app-iem-gap",
                        "properties": {
                            "description": "Allow CDE IEM servers to connect to GP On-Prem IEM Master",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "53211",
                            "destinationAddressPrefix": "10.122.232.130",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "iem-a-p-iem-gap-iem-app",
                        "properties": {
                            "description": "Allow GP On-Prem IEM Master to connect to CDE IEM servers",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "53211",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"10.122.232.130",
                            "access": "Allow",
                            "priority": 160,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-CDE-ITBX-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "admin-a-p-jump-app-all-any",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.40.0/23",
                                "10.49.40.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-p-itbx-app-all-any",
                        "properties": {
                            "description": "Allow CDE IT Toolbox servers to connect to CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-p-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow Edge and Prod-CDE to Prod-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.34.23/32",
                                "10.49.34.23/32",
                                "10.50.34.23/32",
                                "10.51.34.23/32",
                                "10.52.34.23/32",
                                "10.53.34.23/32"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-CDE-LIC-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "admin-a-p-jump-app-all-any",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.40.0/23",
                                "10.49.40.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-p-itbx-app-all-any",
                        "properties": {
                            "description": "Allow CDE IT Toolbox servers to connect to CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-p-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow Edge and Prod-CDE to Prod-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.34.23/32",
                                "10.49.34.23/32",
                                "10.50.34.23/32",
                                "10.51.34.23/32",
                                "10.52.34.23/32",
                                "10.53.34.23/32"
                            ]
                        }
                    },
                    {
                        "name": "lic-a-p-all-any-lic-app-tcp",
                        "properties": {
                            "description": "Allow CDE servers to connect to CDE RDP LIC Server TCP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "139",
                                "445",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "lic-a-p-all-any-lic-app-udp",
                        "properties": {
                            "description": "Allow CDE servers to connect to CDE RDP LIC Server UDP",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 141,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "137",
                                "138"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-CDE-AD-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "admin-a-p-jump-app-all-any",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.40.0/23",
                                "10.49.40.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-p-itbx-app-all-any",
                        "properties": {
                            "description": "Allow CDE IT Toolbox servers to connect to CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-p-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow Edge and Prod-CDE to Prod-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.34.23/32",
                                "10.49.34.23/32",
                                "10.50.34.23/32",
                                "10.51.34.23/32",
                                "10.52.34.23/32",
                                "10.53.34.23/32"
                            ]
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-gp-dns-gap",
                        "properties": {
                            "description": "Allow GPN Cloud CDE AD to GPN On_prem DNS for start of authority records",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "53",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.232.152",
                                "10.122.232.153",
                                "10.138.232.152",
                                "10.138.232.153",
                                "172.30.118.134",
                                "172.30.118.135"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-CDE-LJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "admin-a-p-jump-app-all-any",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.40.0/23",
                                "10.49.40.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-p-itbx-app-all-any",
                        "properties": {
                            "description": "Allow CDE IT Toolbox servers to connect to CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-p-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow Edge and Prod-CDE to Prod-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.34.23/32",
                                "10.49.34.23/32",
                                "10.50.34.23/32",
                                "10.51.34.23/32",
                                "10.52.34.23/32",
                                "10.53.34.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-CDE-SMTP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "admin-a-p-jump-app-all-any",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.40.0/23",
                                "10.49.40.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-p-itbx-app-all-any",
                        "properties": {
                            "description": "Allow CDE IT Toolbox servers to connect to CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-p-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow Edge and Prod-CDE to Prod-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.34.23/32",
                                "10.49.34.23/32",
                                "10.50.34.23/32",
                                "10.51.34.23/32",
                                "10.52.34.23/32",
                                "10.53.34.23/32"
                            ]
                        }
                    },
                    {
                        "name": "smtp-a-p-all-any-smtp-app",
                        "properties": {
                            "description": "Allow PROD-CDE to the PROD-CDE SMTP relays",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "smtp-a-p-smtp-app-pfpt-any",
                        "properties": {
                            "description": "PROD-CDE SMTP Relays to Proofpoint SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "43025",
                                "43465"
                            ],
                            "sourceAddressPrefixes": [],
                            "DestinationAddressPrefixes": [
                                "67.231.148.213",
                                "67.231.156.212"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-CDE-WJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-s-jump-app-all-any",
                        "properties": {
                            "description": "admin-a-p-jump-app-all-any",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.40.0/23",
                                "10.49.40.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.25",
                                "10.49.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-p-itbx-app-all-any",
                        "properties": {
                            "description": "Allow CDE IT Toolbox servers to connect to CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "pki-a-p-pki-app-all-any",
                        "properties": {
                            "description": "Allow CDE PKI Server to connect to CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-p-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-CDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-p-all-any-az-alb",
                        "properties": {
                            "description": "Allow Edge and Prod-CDE to Prod-CDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.34.23/32",
                                "10.49.34.23/32",
                                "10.50.34.23/32",
                                "10.51.34.23/32",
                                "10.52.34.23/32",
                                "10.53.34.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-LJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-SMTP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "smtp-a-g-all-any-smtp-app",
                        "properties": {
                            "description": "Allow PROD-NonCDE to the PROD-NonCDE SMTP relays",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "smtp-a-g-smtp-app-pfpt-any",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "43025",
                                "43465"
                            ],
                            "sourceAddressPrefixes": [],
                            "DestinationAddressPrefixes": [
                                "67.231.148.213",
                                "67.231.156.212"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-WJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-SCAN-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "scan-a-g-jump-app-scan-app",
                        "properties": {
                            "description": "Allow PROD-NCDE Jumpservers to manage Security scanner",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "443",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [ ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "scan-a-g-scan-app-internet-any",
                        "properties": {
                            "description": "Allow Security scanner reach out to Internet on HTTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443",
                                "873"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-DNS-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "dns-a-g-all-any-dns-app-udp",
                        "properties": {
                            "description": "Allow GPN Cloud ranges to GPN Cloud DNS servers",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.0.0/16",
                                "10.49.0.0/16",
                                "10.50.0.0/16",
                                "10.51.0.0/16",
                                "10.52.0.0/16",
                                "10.53.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "dns-a-g-all-any-dns-app-tcp",
                        "properties": {
                            "description": "Allow GPN Cloud ranges to GPN Cloud DNS servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 145,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.0.0/16",
                                "10.49.0.0/16",
                                "10.50.0.0/16",
                                "10.51.0.0/16",
                                "10.52.0.0/16",
                                "10.53.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "dns-a-g-dns-app-dns-gap-out",
                        "properties": {
                            "description": "Allow GPN Cloud DNS to GPN On_prem DNS for zone transfers",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "53",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.232.152",
                                "10.122.232.153",
                                "10.138.232.152",
                                "10.138.232.153",
                                "172.30.118.134",
                                "172.30.118.135"
                            ]
                        }
                    },
                    {
                        "name": "dns-a-g-dns-gap-dns-app-in",
                        "properties": {
                            "description": "Allow GPN On_prem DNS to GPN Cloud DNS for zone transfers",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "53",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [
                                "10.122.232.152",
                                "10.122.232.153",
                                "10.138.232.152",
                                "10.138.232.153",
                                "172.30.118.134",
                                "172.30.118.135"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-AD-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "ad-a-g-ad-app-ad-appy",
                        "properties": {
                            "description": "Allow GPI DC's to GPI DC's on port",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-g-ad-app-dns-gap",
                        "properties": {
                            "description": "Allow GPN Cloud Non-CDE AD to GPN On_prem DNS for start of authority records",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "53",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.232.152",
                                "10.122.232.153",
                                "10.138.232.152",
                                "10.138.232.153",
                                "172.30.118.134",
                                "172.30.118.135"
                            ]
                        }
                    },
                    {
                        "name": "ad-a-g-all-any-ad-app-tcp",
                        "properties": {
                            "description": "Allow GPI domain members to GPI DC's on domain ports TCP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 160,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "25",
                                "53",
                                "88",
                                "135",
                                "137",
                                "139",
                                "389",
                                "445",
                                "464",
                                "636",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [ ]
                        }
                    },
                    {
                        "name": "ad-a-g-all-any-ad-app-udp",
                        "properties": {
                            "description": "Allow GPI domain members to GPI DC's on domain ports UDP",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 165,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "53",
                                "67",
                                "123",
                                "137-138",
                                "389",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-WSUS-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "wsus-a-g-all-any-wsus-app",
                        "properties": {
                            "description": "Allow Non-CDE to connect to Non-CDE WSUS on update port",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "8531",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "wsus-a-g-wsus-app-internet-any",
                        "properties": {
                            "description": "Allow Non-CDE WSUS server to connect to Whitelisted Windows Update Sources over HTTPS and HTTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [ ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-REPO-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app-02",
                        "properties": {
                            "description": "Allow NonCDE to GPN Cloud RHEL REPO for updates",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [                            
                                "10.48.0.0/16",
                                "10.49.0.0/16",
                                "10.50.0.0/16",
                                "10.51.0.0/16",
                                "10.52.0.0/16",
                                "10.53.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-repo-app-internet-any",
                        "properties": {
                            "description": "Cloud Repo server outbound",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "443",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "152.19.134.199",
                                "209.132.181.23",
                                "209.132.181.24",
                                "209.132.181.25"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-AVM-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "vistara-squid-temp-tcp",
                        "properties": {
                            "description": "Trend Micro Antivirus Scanning TCP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"10.48.0.0/13",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443",
                                "4343",
                                "4345",
                                "5274",
                                "389",
                                "8082",
                                "47999",
                                "137",
                                "139",
                                "445",
                                "8080"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "vistara-squid-temp-udp",
                        "properties": {
                            "description": "Trend Micro Antivirus Scanning UDP",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "137",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"10.48.0.0/13",
                            "access": "Allow",
                            "priority": 145,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "avm-a-g-avm-app-all-any-tcp",
                        "properties": {
                            "description": "Trend Micro Antivirus Scanning TCP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443",
                                "4343",
                                "4345",
                                "5274",
                                "389",
                                "8082",
                                "47999",
                                "137",
                                "139",
                                "445",
                                "8080"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "avm-a-g-avm-app-all-any-udp",
                        "properties": {
                            "description": "Trend Micro Antivirus Scanning UDP",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "137",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 155,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "avm-a-g-avm-app-internet-any",
                        "properties": {
                            "description": "Internet access for Antivirus updates from Trend Micro",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-IEM-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "iem-a-g-all-any-iem-app",
                        "properties": {
                            "description": "All Non-cde networks to Non-CDE iem server",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "52311",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "iem-a-g-iem-app-iem-gap",
                        "properties": {
                            "description": "Allow NonCDE IEM servers to connect to GP On-Prem IEM Master",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "52311",
                            "destinationAddressPrefix": "10.122.232.130",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "iem-a-g-iem-gap-iem-app",
                        "properties": {
                            "description": "Allow GP On-Prem IEM Master to connect to NonCDE IEM servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "52311",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"10.122.232.130",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nDEV-LJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-d-jump-app-all-any",
                        "properties": {
                            "description": "Allow DEV Tier2 Jumpservers to DEV VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.200.0/23",
                                "10.49.200.0/23"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow DEV reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-d-all-any-az-alb",
                        "properties": {
                            "description": "Allow DEV to DEV SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.194.23/32",
                                "10.49.194.23/32",
                                "10.50.194.23/32",
                                "10.51.194.23/32",
                                "10.52.194.23/32",
                                "10.53.194.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "git-a-g-jump-app-git-app",
                        "properties": {
                            "description": "Allow Jumpservers to connect to GPN Cloud GIT on 443",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "443",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [ ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nDEV-WJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-d-jump-app-all-any",
                        "properties": {
                            "description": "Allow DEV Tier2 Jumpservers to DEV VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix": "",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.200.0/23",
                                "10.49.200.0/23"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow DEV reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-d-all-any-az-alb",
                        "properties": {
                            "description": "Allow DEV to DEV SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.194.23/32",
                                "10.49.194.23/32",
                                "10.50.194.23/32",
                                "10.51.194.23/32",
                                "10.52.194.23/32",
                                "10.53.194.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "git-a-g-jump-app-git-app",
                        "properties": {
                            "description": "Allow Jumpservers to connect to GPN Cloud GIT on 443",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "443",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 150,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [ ]
                        }
                    },
                    {
                        "name": "lic-a-g-all-any-lic-app-tcp",
                        "properties": {
                            "description": "Allow Non-CDE servers to connect to Non-CDE RDP LIC Server TCP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 160,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "445",
                                "139",
                                "49152"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [ ]
                        }
                    },
                    {
                        "name": "lic-a-g-all-any-lic-app-udp",
                        "properties": {
                            "description": "Allow Non-CDE servers to connect to Non-CDE RDP LIC Server UDP",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 165,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "137",
                                "138"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [ ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nDEV-SMTP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-d-jump-app-all-any",
                        "properties": {
                            "description": "Allow DEV Tier2 Jumpservers to DEV VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.200.0/23",
                                "10.49.200.0/23"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow DEV reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-d-all-any-az-alb",
                        "properties": {
                            "description": "Allow DEV to DEV SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.194.23/32",
                                "10.49.194.23/32",
                                "10.50.194.23/32",
                                "10.51.194.23/32",
                                "10.52.194.23/32",
                                "10.53.194.23/32"
                            ]
                        }
                    },
                    {
                        "name": "smtp-a-d-all-any-smtp-app",
                        "properties": {
                            "description": "Allow DEV to the DEV SMTP relays",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "smtp-a-d-smtp-app-pfpt-any",
                        "properties": {
                            "description": "Allow DEV to DEV SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "43025",
                                "43465"
                            ],
                            "sourceAddressPrefixes": [],
                            "DestinationAddressPrefixes": [
                                "67.231.148.213",
                                "67.231.156.212"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nQA-LJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-q-jump-app-all-any",
                        "properties": {
                            "description": "Allow QA Tier2 Jumpservers to QA VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.168.0/23",
                                "10.49.168.0/23"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-q-all-any-repo-app",
                        "properties": {
                            "description": "Allow QA reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-q-all-any-az-alb",
                        "properties": {
                            "description": "Allow DEV to DEV SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.162.23/32",
                                "10.49.162.23/32",
                                "10.50.162.23/32",
                                "10.51.162.23/32",
                                "10.52.162.23/32",
                                "10.53.162.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nQA-WJUMP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-q-jump-app-all-any",
                        "properties": {
                            "description": "Allow QA Tier2 Jumpservers to QA VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.168.0/23",
                                "10.49.168.0/23"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-q-all-any-repo-app",
                        "properties": {
                            "description": "Allow QA reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-q-all-any-az-alb",
                        "properties": {
                            "description": "Allow DEV to DEV SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.162.23/32",
                                "10.49.162.23/32",
                                "10.50.162.23/32",
                                "10.51.162.23/32",
                                "10.52.162.23/32",
                                "10.53.162.23/32"
                            ]
                        }
                    },
                    {
                        "name": "admin-a-gpn-desk-any-jump-app",
                        "properties": {
                            "description": "Allow GPN Desktop networks to GPN Cloud Jumpservers on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "172.30.0.0/16",
                                "10.216.0.0/16"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nQA-SMTP-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-q-jump-app-all-any",
                        "properties": {
                            "description": "Allow QA Tier2 Jumpservers to QA VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [
                                "10.48.168.0/23",
                                "10.49.168.0/23"
                            ],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-q-all-any-repo-app",
                        "properties": {
                            "description": "Allow QA reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-q-all-any-az-alb",
                        "properties": {
                            "description": "Allow DEV to DEV SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.162.23/32",
                                "10.49.162.23/32",
                                "10.50.162.23/32",
                                "10.51.162.23/32",
                                "10.52.162.23/32",
                                "10.53.162.23/32"
                            ]
                        }
                    },
                    {
                        "name": "smtp-a-q-all-any-smtp-app",
                        "properties": {
                            "description": "Allow QA to the QA SMTP relays",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "smtp-a-q-smtp-app-pfpt-any",
                        "properties": {
                            "description": "Allow QA to QA SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "43025",
                                "43465"
                            ],
                            "sourceAddressPrefixes": [],
                            "DestinationAddressPrefixes": [
                                "67.231.148.213",
                                "67.231.156.212"
                            ]
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-ITBX-WSS-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-GIT-PUP-WSS-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        },
        {
            "type": "Microsoft.Network/networkSecurityGroups",
            "name": "[parameters('nPROD-NCDE-GIT-SAT-ANY-ADMIN')]",
            "apiVersion": "2017-10-01",
            "location": "[resourceGroup().location]",
            "scale": null,
            "properties": {
                "securityRules": [
                    {
                        "name": "ad-a-p-ad-app-all-any-tcp",
                        "properties": {
                            "description": "TCP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "135",
                                "137",
                                "139",
                                "445",
                                "464",
                                "5722",
                                "9389",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "ad-a-p-ad-app-all-any-udp",
                        "properties": {
                            "description": "UDP Allow GPP DC's to GPP domain members on domain ports",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 101,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "88",
                                "67",
                                "123",
                                "137-138",
                                "445",
                                "464",
                                "1024-5000",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "admin-a-g-jump-app-all-any",
                        "properties": {
                            "description": "Allow PROD-NonCDE Tier2 Jumpservers to PROD-NonCDE VM's on SSH and RDP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 110,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.104.0/23",
                                "10.49.104.0/23"
                            ]
                        }
                    },
                    {
                        "name": "Auth-a-n-all-any-az-alb",
                        "properties": {
                            "description": "Non-CDE network access to Auhtorization internal Load balancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "10.48.98.17/32",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 100,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "389",
                                "636"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-udp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Udp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 105,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53",
                                "9999"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "Dns-a-g-all-any-az-alb-tcp",
                        "properties": {
                            "description": "Allow PRD-NonCDE to DNS Loadbalancer",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 106,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "53"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.49.98.25",
                                "10.48.98.25"
                            ]
                        }
                    },
                    {
                        "name": "itbx-a-g-itbx-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE IT Toolbox servers to connect to Non-CDE for Admin and automation",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "22",
                                "443",
                                "3389"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "pki-a-g-pki-app-all-any",
                        "properties": {
                            "description": "Allow Non-CDE PKI Server to connect to Non-CDE servers",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 130,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "135",
                                "49152-65535"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "repo-a-g-all-any-repo-app",
                        "properties": {
                            "description": "Allow PROD-NCDE reach out to Google Cloud repos",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 120,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [
                                "80",
                                "443"
                            ],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.122.211.22",
                                "23.236.57.179",
                                "74.125.141.139",
                                "74.125.141.100",
                                "74.125.141.113",
                                "74.125.141.138",
                                "74.125.141.102",
                                "74.125.141.101",
                                "66.35.62.162",
                                "67.203.2.67",
                                "140.211.169.196",
                                "140.211.169.206",
                                "152.19.134.142",
                                "209.132.181.16",
                                "8.43.85.67",
                                "152.19.134.198",
                                "209.132.181.15"
                            ]
                        }
                    },
                    {
                        "name": "Smtp-a-g-all-any-az-alb",
                        "properties": {
                            "description": "Allow PROD-NCDE to PROD-NCDE SMTP on SMTP",
                            "protocol": "Tcp",
                            "sourcePortRange": "*",
                            "destinationPortRange": "25",
                            "destinationAddressPrefix": "",
                            "sourceAddressPrefix":"*",
                            "access": "Allow",
                            "priority": 140,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": [
                                "10.48.98.23/32",
                                "10.49.98.23/32",
                                "10.50.98.23/32",
                                "10.51.98.23/32",
                                "10.52.98.23/32",
                                "10.53.98.23/32"
                            ]
                        }
                    },
                    {
                        "name": "shared-d-gpn-all-any-cde-any",
                        "properties": {
                            "description": "DENY ALL Outbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "shared-d-a-all-any-all-any",
                        "properties": {
                            "description": "DENY ALL Inbound to CDE and PROD-Edge",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "destinationAddressPrefix": "*",
                            "sourceAddressPrefix":"*",
                            "access": "Deny",
                            "priority": 4000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ],
                "defaultSecurityRules": [
                    {
                        "name": "AllowVnetInBound",
                        "properties": {
                            "description": "Allow inbound traffic from all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowAzureLoadBalancerInBound",
                        "properties": {
                            "description": "Allow inbound traffic from azure load balancer",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "AzureLoadBalancer",
                            "destinationAddressPrefix": "*",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllInBound",
                        "properties": {
                            "description": "Deny all inbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Inbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowVnetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "VirtualNetwork",
                            "destinationAddressPrefix": "VirtualNetwork",
                            "access": "Allow",
                            "priority": 65000,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "AllowInternetOutBound",
                        "properties": {
                            "description": "Allow outbound traffic from all VMs to Internet",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "Internet",
                            "access": "Allow",
                            "priority": 65001,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    },
                    {
                        "name": "DenyAllOutBound",
                        "properties": {
                            "description": "Deny all outbound traffic",
                            "protocol": "*",
                            "sourcePortRange": "*",
                            "destinationPortRange": "*",
                            "sourceAddressPrefix": "*",
                            "destinationAddressPrefix": "*",
                            "access": "Deny",
                            "priority": 65500,
                            "direction": "Outbound",
                            "sourcePortRanges": [],
                            "destinationPortRanges": [],
                            "sourceAddressPrefixes": [],
                            "destinationAddressPrefixes": []
                        }
                    }
                ]
            },
            "dependsOn": []
        }
    ],
    "outputs" : {
        "nsg-names" : {

        }
    }
}